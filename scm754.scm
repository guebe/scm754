; regression tests

(+ 1 (+ 2.5 (+ 3 (+ 4.5 (+ 5 (+ 6.25 (+ 7 (+ 8.75 (+ 9 (+ 10.5 (+ 11 (+ 12.25)))))))))))) ; 80.75

#T ; #t
#F ; #f

; The following tests are from:
; Scheme 9 from Empty Space Test Suite
; By Nils M Holm, 2007-2018
; In the public domain

;;; Comments

;  This is a comment

;#| This is a block comment |#
;
;   #| Nested #| block |# comment |#
;
;   #| Nested
;      #| multi-line |#
;         block comment |#
;
;	 #|#|#||#|# nonsense |#
;
;	 #| #|#||#|# more nonsense #|## |||#|#

; Objects

'x ; 'x
'mississippi ; 'mississippi
'MIssissiPPi ; 'MIssissiPPi
'!$%&*+-./^_ ; '!$%&*+-./^_

; Booleans

#t ; #t
#f ; #f

; Chars

#\x ; #\x
#\C ; #\C
#\( ; #\(
#\) ; #\)
#\; ; #\;
;#\space ;#\space
;#\newline ;#\newline
#\  ; a space
; a newline char on next line
#\

; Strings

"test" ;"test"
"TeSt" ;"TeSt"
"TEST" ;"TEST"
"hello, world!" ;"hello, world!"
;"\"hello, world!\"" "\"hello, world!\""
"a\\/b" ;"a\\/b"
"(((;)))" ;"(((;)))"

; Pairs / Lists

'() ;'()
'(a b c) ;'(a b c)
'(a (b) c) ;'(a (b) c)
'(((((x))))) ;'(((((x)))))
;'((caar . cdar) . (cadr . cddr)) ;'((caar . cdar) . (cadr . cddr))

; Integers

0 ; 0
1 ; 1
1234567 ; 1234567
-0 ; 0
-1 ; -1
-1234567 ; -1234567
;123456789012345678901234567890 ; 123456789012345678901234567890
;-123456789012345678901234567890 ; -123456789012345678901234567890

#b10101010100101010101 ; 698709
#b+10101010100101010101 ; +698709
#b-10101010100101010101 ; -698709
;#d1234567890987654321 ; 1234567890987654321
;#d+1234567890987654321 ; +1234567890987654321
;#d-1234567890987654321 ; -1234567890987654321
#o123456707654321 ; 5744369817809
#o+123456707654321 ; +5744369817809
#o-123456707654321 ; -5744369817809
;#x123456789abcdef0fedcba98765432 ; 94522879700260683132212139638805554
;#x+123456789abcdef0fedcba98765432 ; +94522879700260683132212139638805554
;#x-123456789abcdef0fedcba98765432 ; -94522879700260683132212139638805554

; Real Numbers

0.0 ; 0.0
-0.0 ; -0.0
1.0 ; 1.0
-1.0 ; -1.0
12345.0 ; 12345.0
-12345.0 ; -12345.0
1.2345 ; 1.2345
-1.2345 ; -1.2345
0.12345 ; 0.12345
-0.12345 ; -0.12345
-0.00012345 ; -0.00012345
0.1 ; 0.1
0.01 ; 0.01
0.001 ; 0.001
0.0000000000001 ; 0.0000000000001
1e0 ; 1.0
1e-0 ; 1.0
1e1 ; 10.0
1e2 ; 100.0
1e5 ; 100000.0
1e10 ; 10000000000.0
1e-1 ; 0.1
1e-2 ; 0.01
1e-5 ; 0.00001
1e-10 ; 0.0000000001
123.456e0 ; 123.456
123.456e1 ; 1234.56
123.456e2 ; 12345.6
123.456e3 ; 123456.0
123.456e4 ; 1234560.0
123.456e5 ; 12345600.0
123.456e10 ; 1234560000000.0
-123.456e0 ; -123.456
-123.456e1 ; -1234.56
-123.456e2 ; -12345.6
-123.456e3 ; -123456.0
-123.456e4 ; -1234560.0
-123.456e5 ; -12345600.0
-123.456e10 ; -1234560000000.0
123.456e-1 ; 12.3456
123.456e-2 ; 1.23456
123.456e-3 ; 0.123456
123.456e-4 ; 0.0123456
123.456e-5 ; 0.00123456
123.456e-10 ; 0.0000000123456
-123.456e-1 ; -12.3456
-123.456e-2 ; -1.23456
-123.456e-3 ; -0.123456
-123.456e-4 ; -0.0123456
-123.456e-5 ; -0.00123456
-123.456e-10 ; -0.0000000123456
;+123.45e+678 ; 123.45e678
;-123.45e+678 ; -123.45e678
;+123.45e-678 ; 123.45e-678
;-123.45e-678 ; -123.45e-678
1. ; 1.0
.1 ; 0.1
1.e1 ; 10.0
.1e1 ; 1.0
1000e0 ; 1e3
100e1 ; 1e3
10e2 ; 1e3
1e3 ; 1e3
.1e4 ; 1e3
.01e5 ; 1e3
.001e6 ; 1e3
;12345678.901D10 ; 1.2345678901e+17
12345678.901E10 ; 1.2345678901e+17
;12345678.901F10 ; 1.2345678901e+17
;12345678.901L10 ; 1.2345678901e+17
;12345678.901S10 ; 1.2345678901e+17

;;; Syntax

; quote

(quote foo) ; 'foo
(quote quote) ; 'quote
(quote #t) ; #t
(quote 1) ; 1
(quote #\X) ; #\X
(quote "abc") ; "abc"
(quote ()) ; '()
(quote (1 2 3)) ; '(1 2 3)
;(quote #(1 2 3)) ; '#(1 2 3)
(quote (lambda (x) x)) ; '(lambda (x) x)
'1 ; '1
''1 ; ''1
'''1 ; '''1
'#f ; #f
'1 ; 1
'#\b ; #\b
'"abc" ; "abc"

; Integer Arithmetics

(+  1234567890  9876543210) ;  11111111100
(+  1234567890 -9876543210) ;  -8641975320
(+ -1234567890  9876543210) ;   8641975320
(+ -1234567890 -9876543210) ; -11111111100
(+  9876543210  1234567890) ;  11111111100
(+  9876543210 -1234567890) ;   8641975320
(+ -9876543210  1234567890) ;  -8641975320
(+ -9876543210 -1234567890) ; -11111111100
(+ 1234567890 0) ; 1234567890
(+ 0 1234567890) ; 1234567890
(+ 1 2 3 4 5 6 7 8 9 10) ; 55
(+ 1) ; 1
(+) ; 0

; === Beginning of R4RS tests ===

; R4RS tests, 6.1 booleans

#t ; #t
#f ; #f
'#f ; #f

; R4RS tests, 6.3 pairs and lists

'(a . (b . (c . (d . (e . ()))))) ; '(a b c d e))
'(a . (b . (c . d))) ; '(a b c . d))

; R4RS tests, 6.5 numbers

(+ 3 4) ; 7
(+ 3) ; 3
(+) ; 0

; R4RS tests, 6.6 characters

#\a ; #\a
#\A ; #\A
#\( ; #\(
#\  ; #\space
;#\space ; #\space
;#\newline ; #\newline
